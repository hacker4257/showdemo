// Prisma schema for pharmaceutical e-commerce platform

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Product categories (Small Molecules, Biologics, Peptides, etc.)
model Category {
  id          String    @id @default(cuid())
  name        String
  nameEn      String
  slug        String    @unique
  description String?
  descriptionEn String?
  products    Product[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

// Main product model
model Product {
  id              String    @id @default(cuid())
  name            String
  nameEn          String
  casNumber       String?   @unique
  molecularFormula String?
  molecularWeight Float?
  purity          String?   // e.g., "â‰¥98%"
  description     String?   @db.Text
  descriptionEn   String?   @db.Text
  specifications  String?   @db.Text // JSON string for various specs
  applications    String?   @db.Text
  applicationsEn  String?   @db.Text
  imageUrl        String?
  structureImage  String?   // Chemical structure image
  price           Float?
  inStock         Boolean   @default(true)
  featured        Boolean   @default(false)

  categoryId      String
  category        Category  @relation(fields: [categoryId], references: [id])

  inquiries       Inquiry[]

  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@index([categoryId])
  @@index([casNumber])
}

// Inquiry/Quote requests
model Inquiry {
  id          String   @id @default(cuid())
  productId   String
  product     Product  @relation(fields: [productId], references: [id])

  // Customer information
  name        String
  email       String
  company     String?
  phone       String?
  country     String?

  // Inquiry details
  quantity    String
  message     String?  @db.Text

  // Status tracking
  status      InquiryStatus @default(PENDING)
  notes       String?  @db.Text // Admin notes

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([productId])
  @@index([email])
  @@index([status])
}

enum InquiryStatus {
  PENDING
  CONTACTED
  QUOTED
  COMPLETED
  CANCELLED
}

// Admin users
model User {
  id            String    @id @default(cuid())
  email         String    @unique
  name          String?
  passwordHash  String
  role          UserRole  @default(ADMIN)

  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

enum UserRole {
  ADMIN
  SUPER_ADMIN
}

// Contact form submissions
model Contact {
  id        String   @id @default(cuid())
  name      String
  email     String
  company   String?
  subject   String
  message   String   @db.Text
  status    ContactStatus @default(NEW)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
  @@index([status])
}

enum ContactStatus {
  NEW
  READ
  REPLIED
  ARCHIVED
}
